---
layout: layouts/base.njk
---
<header class="list-header">
    <h2><a href="{{ page.url }}">{{ title }}</a></h2>
    <p class="tagline">{{ description }}</p>
</header>

<section class="post-list">
    {% for post in pagination.items %}
    {% set firstAuthorKey = post.data.author.split(',')[0] | trim if post.data.author else '' %}
    {% set matchedAuthor = authors | findAuthorByKey(firstAuthorKey) %}
    {% set matchedEditor = collections.editors | findEditorByKey(firstAuthorKey) %}
    {% set bylineName = post.data.name or (matchedEditor.data.name if matchedEditor else (matchedAuthor.name if matchedAuthor else '')) %}
    {% set bylineImage = matchedEditor.data.image if matchedEditor else (matchedAuthor.image if matchedAuthor else '') %}
    <article class="post-preview">
        {% if post.data.image %}
        <a href="{{ post.url }}" class="none">
            <img src="{{ post.data.image }}" alt="{{ post.data.title }}" class="post-preview-image">
        </a>
        {% endif %}
        <time datetime="{{ post.date | htmlDateString }}">
            {{ post.date | readableDate("LLLL yyyy") }}
        </time>
        <h3 class="post-title">
            <a href="{{ post.url }}">{{ post.data.title }}</a>
        </h3>
        {% if bylineName %}
        <p class="post-byline">
            {% if bylineImage %}<img src="{{ bylineImage }}" alt="{{ bylineName }}" class="post-byline-avatar">{% endif %}
            <span>{{ bylineName }}</span>
        </p>
        {% endif %}
        <p>
            {%- if post.data.description -%}
                {{ post.data.description }}
            {%- else -%}
                {{ post.templateContent | striptags | truncate(140) }}
            {%- endif -%}
        </p>
    </article>
    {% endfor %}
</section>

<style>
.post-preview-image {
    width: 100%;
    max-height: 320px;
    object-fit: cover;
    border-radius: 6px;
    margin: 0 0 0.8rem 0;
    border: 1px solid var(--border-color);
}
.post-byline {
    display: inline-flex;
    gap: 0.5rem;
    align-items: center;
    margin: 0.25rem 0 0.75rem 0;
    font-size: 0.95rem;
    color: var(--muted-text);
}
.post-byline-avatar {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    object-fit: cover;
}
</style>

<nav class="pagination" aria-label="Pagination">
    <a href="{{ pagination.href.previous or '#' }}" 
       class="pagination-item{% if not pagination.href.previous %} disabled{% endif %}">
        ← Newer
    </a>
    
    <div class="pagination-numbers">
        {% if pagination.pageNumber == 0 %}
            <span class="pagination-number active">1</span>
        {% else %}
            <a href="/writings/" class="pagination-number">1</a>
        {% endif %}
        
        {% if pagination.pageNumber > 1 %}
            <span class="pagination-dots">...</span>
        {% endif %}
        
        {% if pagination.pageNumber > 0 %}
            <a href="{{ pagination.href.previous }}" 
               class="pagination-number{% if pagination.pageNumber == 1 %} active{% endif %}">
                {{ pagination.pageNumber }}
            </a>
        {% endif %}
        
        {% if pagination.href.next %}
            <a href="{{ pagination.href.next }}" class="pagination-number">
                {{ pagination.pageNumber + 1 }}
            </a>
        {% endif %}
        
        {% if pagination.totalPages > pagination.pageNumber + 2 %}
            <span class="pagination-dots">...</span>
            <a href="#" class="pagination-number">{{ pagination.totalPages }}</a>
        {% endif %}
    </div>
    
    <a href="{{ pagination.href.next or '#' }}" 
       class="pagination-item{% if not pagination.href.next %} disabled{% endif %}">
        Older →
    </a>
</nav>
